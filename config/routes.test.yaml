mqtt:
  broker: "mosquitto"  # Docker service name
  port: 1883
  username: null
  password: null
  client_id: "webhook-bridge-test"
  keepalive: 60

api_version: "v1"

routes:
  # Test route 1: Simple POST with query parameters
  - path: "/test/simple"
    method: "POST"
    mqtt_topic: "test/simple"
    parameters:
      - name: "message"
        type: "string"
        required: true
        location: "query"
    payload_template: |
      {
        "message": "{{message}}",
        "timestamp": "{{now()}}"
      }
    qos: 1
    retain: false

  # Test route 2: POST with path parameter
  - path: "/device/{device_id}/control"
    method: "POST"
    mqtt_topic: "test/devices/{device_id}/command"
    parameters:
      - name: "device_id"
        type: "string"
        required: true
        location: "path"
      - name: "action"
        type: "string"
        required: true
        location: "body"
        enum: ["on", "off", "toggle"]
    payload_template: |
      {
        "device": "{{device_id}}",
        "action": "{{action}}",
        "source": "test"
      }
    qos: 1
    retain: false

  # Test route 3: POST with body parameters and validation
  - path: "/sensor/update"
    method: "POST"
    mqtt_topic: "test/sensor/data"
    parameters:
      - name: "sensor_id"
        type: "string"
        required: true
        location: "body"
      - name: "value"
        type: "float"
        required: true
        location: "body"
        min: 0.0
        max: 100.0
      - name: "unit"
        type: "string"
        required: false
        location: "body"
        default: "celsius"
    payload_template: |
      {
        "sensor": "{{sensor_id}}",
        "value": {{value}},
        "unit": "{{unit}}",
        "timestamp": "{{now()}}"
      }
    qos: 2
    retain: false

  # Test route 4: GET with enum validation
  - path: "/automation/trigger"
    method: "GET"
    mqtt_topic: "test/automation/scene"
    parameters:
      - name: "scene"
        type: "string"
        required: true
        location: "query"
        enum: ["morning", "evening", "night"]
    payload_template: |
      {
        "scene": "{{scene}}",
        "triggered_at": "{{now()}}",
        "mode": "test"
      }
    qos: 1
    retain: false

  # Test route 5: Multiple path parameters
  - path: "/room/{room_id}/device/{device_id}/state"
    method: "PUT"
    mqtt_topic: "test/room/{room_id}/device/{device_id}/state"
    parameters:
      - name: "room_id"
        type: "string"
        required: true
        location: "path"
      - name: "device_id"
        type: "string"
        required: true
        location: "path"
      - name: "state"
        type: "boolean"
        required: true
        location: "body"
      - name: "brightness"
        type: "integer"
        required: false
        location: "body"
        min: 0
        max: 100
    payload_template: |
      {
        "room": "{{room_id}}",
        "device": "{{device_id}}",
        "state": {{state}},
        {%- if brightness is defined %}
        "brightness": {{brightness}},
        {%- endif %}
        "timestamp": "{{now()}}"
      }
    qos: 1
    retain: true
